<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Legal document analysis assistant demo UI" />
    <meta name="color-scheme" content="light dark" />
    <title>Legal Assistant</title>
    <style>
      :root {
        --bg-start: #667eea; --bg-end: #764ba2; --surface: #ffffff;
        --text: #111827; --muted: #6b7280; --border: #e5e7eb; --ring: #6366f1; --success: #22c55e;
        --shadow: 0 10px 30px rgba(0,0,0,.15);
      }
      [data-theme="dark"] {
        --bg-start: #1f2937; --bg-end: #111827; --surface: #0b1220;
        --text: #e5e7eb; --muted: #9ca3af; --border: #1f2937; --ring: #818cf8; --success: #34d399;
        --shadow: 0 10px 30px rgba(0,0,0,.5);
      }
      *{box-sizing:border-box}
      html,body{height:100%}
      body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--text);
        background:linear-gradient(135deg,var(--bg-start),var(--bg-end));display:grid;place-items:center;padding:24px}
      .app{width:min(920px,100%)}
      header{text-align:center;margin-bottom:18px}
      h1{margin:0 0 6px;font-size:clamp(1.8rem,1rem + 3vw,2.4rem)}
      .card{background:var(--surface);border:1px solid var(--border);border-radius:18px;padding:28px;box-shadow:var(--shadow)}
      .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
      textarea{width:100%;min-height:180px;padding:16px;border-radius:12px;border:2px solid var(--border);font:inherit;resize:vertical;background:transparent;color:inherit}
      textarea:focus{outline:none;border-color:var(--ring);box-shadow:0 0 0 4px color-mix(in oklab,var(--ring) 20%,transparent)}
      .btn{appearance:none;border:0;cursor:pointer;padding:14px 18px;border-radius:999px;font-weight:600;transition:transform .12s ease, box-shadow .12s ease}
      .btn-primary{width:100%;font-size:1.05rem;background:linear-gradient(45deg,#667eea,#764ba2);color:#fff;box-shadow:0 8px 16px rgba(0,0,0,.18)}
      .btn-primary:hover{transform:translateY(-1px)}
      .response{margin-top:18px;padding:18px;border:1px solid var(--border);background:color-mix(in oklab,var(--surface) 85%, #10b981 7%);border-left:6px solid var(--success);border-radius:12px}
      .loading{display:inline-flex;gap:10px;align-items:center;color:#6b7280}
      .spinner{width:18px;height:18px;border-radius:50%;border:3px solid currentColor;border-right-color:transparent;animation:spin .7s linear infinite}
      @keyframes spin{to{transform:rotate(360deg)}}
      @media (prefers-reduced-motion:reduce){.btn{transition:none}.spinner{animation:none}}
    </style>
  </head>
  <!-- Hide body to prevent flicker before auth check -->
  <body style="display:none">
    <script>
      (function(){
        try {
          var authed = sessionStorage.getItem('authenticated') === 'true' || localStorage.getItem('authenticated') === 'true';
          if (!authed) { window.location.replace('./login.html'); return; }
          // If authed, reveal body
          document.body.style.display = '';
        } catch (e) { document.body.style.display = ''; }
      })();
    </script>

    <div class="app">
      <header>
        <h1>‚öñÔ∏è Legal Document Analysis Assistant</h1>
      </header>

      <main class="card">
        <form id="form" novalidate>
          <label class="sr-only" for="question">Question</label>
          <textarea id="question" name="question" placeholder="" maxlength="1000" required></textarea>
          <button id="analyzeBtn" class="btn btn-primary" type="submit">üöÄ Analyze</button>
        </form>

        <section id="response" class="response" role="region" aria-live="polite" aria-busy="false" hidden>
          <div id="responseContent"></div>
        </section>
      </main>
    </div>

    <script>
      const $ = (sel) => document.querySelector(sel);
      const form = $('#form');
      const questionEl = $('#question');
      const analyzeBtn = $('#analyzeBtn');
      const response = $('#response');
      const responseContent = $('#responseContent');

      // Submit: Ctrl/Cmd + Enter
      questionEl.addEventListener('keydown', (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') form.requestSubmit();
      });

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        if (!questionEl.value.trim()) { questionEl.reportValidity(); return; }
        analyzeBtn.disabled = true;
        response.hidden = false;
        response.setAttribute('aria-busy', 'true');
        responseContent.innerHTML = '';
        const loading = document.createElement('div');
        loading.className = 'loading';
        loading.innerHTML = '<span class="spinner" aria-hidden="true"></span><span>ü§ñ Analyzing‚Ä¶</span>';
        responseContent.appendChild(loading);

        try {
          const userQuestion = questionEl.value;
          await new Promise((res)=>setTimeout(res, 900));
          responseContent.innerHTML = '';

          const summary = document.createElement('p');
          summary.textContent = 'Demo: connect a backend (e.g., AWS Bedrock Agent) to analyze your text.';
          const echo = document.createElement('blockquote');
          echo.style.margin = '8px 0 0';
          echo.style.whiteSpace = 'pre-wrap';
          echo.textContent = userQuestion;
          responseContent.append(summary, echo);
        } catch {
          responseContent.textContent = 'Something went wrong. Please try again.';
          responseContent.style.color = 'crimson';
        } finally {
          analyzeBtn.disabled = false;
          response.setAttribute('aria-busy', 'false');
        }
      });
    </script>
  </body>
</html>
